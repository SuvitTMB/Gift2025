var _0x1872e4=_0x28cf;(function(_0x53e043,_0x3f06b2){var _0x170ff=_0x28cf,_0x5e2f36=_0x53e043();while(!![]){try{var _0x421ba8=-parseInt(_0x170ff(0x27f))/0x1+-parseInt(_0x170ff(0x231))/0x2+-parseInt(_0x170ff(0x1f5))/0x3+-parseInt(_0x170ff(0x1fa))/0x4*(-parseInt(_0x170ff(0x1ee))/0x5)+parseInt(_0x170ff(0x227))/0x6*(parseInt(_0x170ff(0x26f))/0x7)+-parseInt(_0x170ff(0x1c2))/0x8*(-parseInt(_0x170ff(0x1f9))/0x9)+-parseInt(_0x170ff(0x26b))/0xa*(-parseInt(_0x170ff(0x1aa))/0xb);if(_0x421ba8===_0x3f06b2)break;else _0x5e2f36['push'](_0x5e2f36['shift']());}catch(_0xbd4d37){_0x5e2f36['push'](_0x5e2f36['shift']());}}}(_0x3ba1,0x6a9cd));var dateString=new Date()[_0x1872e4(0x239)](_0x1872e4(0x18b),{'timeZone':'Asia/Jakarta'}),today=new Date(),dd=String(today[_0x1872e4(0x267)]())[_0x1872e4(0x20c)](0x2,'0'),mm=String(today[_0x1872e4(0x1c4)]()+0x1)[_0x1872e4(0x20c)](0x2,'0'),yyyy=today[_0x1872e4(0x1d2)]()+0x21f,gID,gStatus,xMaxGift=0x0,xNewyearLimit=0x16,xOrderLimit=0xfa,xBMStatus=0x0,xSendZoneApprove=0x0,zBM_Address='',zBM_Phone='',zEmpID_Staff1='',zEmpName_Staff1='',zPhone_Staff1='',zEmpID_Staff2='',zEmpName_Staff2='',zPhone_Staff2='',zZoneMemoToBM='';$(document)[_0x1872e4(0x1d7)](function(){var _0x3e6879=_0x1872e4;sessionStorage[_0x3e6879(0x209)]('EmpID_Newyear')==null&&(location[_0x3e6879(0x25a)]='index.html'),gID=getParameterByName(_0x3e6879(0x1ba)),gStatus=getParameterByName('gStatus'),Connect_DB(),CheckBudget(),GetUserOrder(gID),LoadGiftStock();});function getParameterByName(_0x3c5ba8,_0x915cc3){var _0x7380d6=_0x1872e4;str='';if(!_0x915cc3)_0x915cc3=window['location'][_0x7380d6(0x25a)];_0x3c5ba8=_0x3c5ba8[_0x7380d6(0x1fe)](/[\[\]]/g,_0x7380d6(0x237));var _0x151576=new RegExp(_0x7380d6(0x1d1)+_0x3c5ba8+_0x7380d6(0x22b)),_0x389013=_0x151576[_0x7380d6(0x194)](_0x915cc3);if(!_0x389013)return null;if(!_0x389013[0x2])return'';return decodeURIComponent(_0x389013[0x2][_0x7380d6(0x1fe)](/\+/g,'\x20'));}function LoadDetail(){var _0x1e64fe=_0x1872e4;dbNewyearData[_0x1e64fe(0x1c6)](firebase[_0x1e64fe(0x228)][_0x1e64fe(0x238)][_0x1e64fe(0x245)](),'==',gID)['get']()[_0x1e64fe(0x1b7)](_0x292a20=>{var _0x44a706=_0x1e64fe;_0x292a20[_0x44a706(0x1cb)](_0x57d8ee=>{var _0x3c2872=_0x44a706;xBMStatus=_0x57d8ee[_0x3c2872(0x210)]()['BMStatus'],zBM_Address=_0x57d8ee[_0x3c2872(0x210)]()[_0x3c2872(0x22a)],zBM_Phone=_0x57d8ee['data']()[_0x3c2872(0x213)],zEmpID_Staff1=_0x57d8ee[_0x3c2872(0x210)]()[_0x3c2872(0x223)],zEmpName_Staff1=_0x57d8ee['data']()[_0x3c2872(0x27b)],zPhone_Staff1=_0x57d8ee['data']()[_0x3c2872(0x19f)],zEmpID_Staff2=_0x57d8ee[_0x3c2872(0x210)]()[_0x3c2872(0x26c)],zEmpName_Staff2=_0x57d8ee[_0x3c2872(0x210)]()[_0x3c2872(0x220)],zPhone_Staff2=_0x57d8ee[_0x3c2872(0x210)]()['Phone_Staff2'],zZoneMemoToBM=_0x57d8ee[_0x3c2872(0x210)]()[_0x3c2872(0x198)];});});}var xBMAllocated=0x0,xBMEmpID='',xBMName='',xBranchName='',xZone='',xRH='';function CheckBudget(){var _0x41d150=_0x1872e4,_0x4f0ed1='',_0x2ecfa3='';_0x4f0ed1+=_0x41d150(0x274),_0x4f0ed1+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',_0x4f0ed1+=_0x41d150(0x1d3),dbNewyearData[_0x41d150(0x1c6)](firebase['firestore'][_0x41d150(0x238)]['documentId'](),'==',gID)['get']()[_0x41d150(0x1b7)](_0x31d318=>{var _0x11c9ba=_0x41d150;_0x31d318['forEach'](_0x38801f=>{var _0x2ef7d6=_0x28cf;xBMStatus=_0x38801f[_0x2ef7d6(0x210)]()['BMStatus'];if(_0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x271)]==0x0)xMsg=_0x2ef7d6(0x1ed),_0x2ecfa3=_0x2ef7d6(0x21f);else{if(_0x38801f[_0x2ef7d6(0x210)]()['BMStatus']==0x1)xMsg=_0x2ef7d6(0x22c),_0x2ecfa3=_0x2ef7d6(0x25e);else{if(_0x38801f['data']()[_0x2ef7d6(0x271)]==0x2)xMsg=_0x2ef7d6(0x230),_0x2ecfa3='<font\x20color=\x27#0056ff\x27><b>ส่งโซนอนุมัติ</b></font>';else{if(_0x38801f[_0x2ef7d6(0x210)]()['BMStatus']==0x3)xMsg='โซนแจ้ง<br>ทบทวน',_0x2ecfa3=_0x2ef7d6(0x204);else{if(_0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x271)]==0x8)xMsg=_0x2ef7d6(0x21d),_0x2ecfa3=_0x2ef7d6(0x1e0);else _0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x271)]==0x9&&(xMsg=_0x2ef7d6(0x1b0),_0x2ecfa3=_0x2ef7d6(0x23a));}}}}xBMEmpID=_0x38801f['data']()['BMEmpID'],xBMName=_0x38801f['data']()[_0x2ef7d6(0x211)],xBranchName=_0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x264)]+'\x20('+_0x38801f['data']()[_0x2ef7d6(0x1fb)]+')',xZone=_0x38801f[_0x2ef7d6(0x210)]()['EmpZone'],xRH=_0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x1e1)],_0x4f0ed1+=_0x2ef7d6(0x1d9),_0x4f0ed1+=_0x2ef7d6(0x24f),_0x4f0ed1+=_0x2ef7d6(0x17d)+_0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x264)]+'\x20('+_0x38801f[_0x2ef7d6(0x210)]()[_0x2ef7d6(0x1fb)]+')</b></td></tr>',_0x4f0ed1+=_0x2ef7d6(0x273),_0x4f0ed1+='<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>'+_0x38801f['data']()[_0x2ef7d6(0x211)]+_0x2ef7d6(0x1b3),_0x4f0ed1+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สถานะ</td>',_0x4f0ed1+=_0x2ef7d6(0x17d)+_0x2ecfa3+'</b></td></tr>',_0x4f0ed1+=_0x2ef7d6(0x1e4),_0x4f0ed1+=_0x2ef7d6(0x17d)+numberWithCommas(_0x38801f[_0x2ef7d6(0x210)]()['BMAllocated'])+_0x2ef7d6(0x195),_0x4f0ed1+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สั่งไปแล้ว</td>',_0x4f0ed1+=_0x2ef7d6(0x17d)+numberWithCommas(_0x38801f[_0x2ef7d6(0x210)]()['UseBudget'])+_0x2ef7d6(0x195),xBMAllocated=_0x38801f['data']()[_0x2ef7d6(0x1f3)];}),_0x4f0ed1+=_0x11c9ba(0x1d6),_0x4f0ed1+=_0x11c9ba(0x1ab),$(_0x11c9ba(0x1a5))['html'](_0x4f0ed1);});}var GetOrderArr=[];function GetUserOrder(_0x43665f){var _0x3ea69d=_0x1872e4,_0x2277a0=0x0;dbGiftOrder[_0x3ea69d(0x1c6)]('RefID','==',_0x43665f)[_0x3ea69d(0x263)]()[_0x3ea69d(0x1b7)](_0x126f4f=>{var _0x127863=_0x3ea69d;_0x126f4f[_0x127863(0x1cb)](_0x2970af=>{var _0x5b7d2f=_0x127863;GetOrderArr[_0x5b7d2f(0x1a7)]({'RefGift':_0x2970af['data']()['RefGift'],'StockName':_0x2970af['data']()[_0x5b7d2f(0x269)],'OrderGift':_0x2970af[_0x5b7d2f(0x210)]()[_0x5b7d2f(0x1ac)],'ID':_0x2970af['id']});});});}var xCheckOrder=0x0,xCountRec=0x0,xSumAllPrice=0x0,xSumUnitPrice=0x0,xTotalUnitPrice=0x0,xBalance=0x0;function _0x3ba1(){var _0x213f9b=['OrderGiftID13','#DisplaySaveGift','คลิก<br>สั่งจอง','1370yZnjEY','StockView','#idSendZoneApprove','<input\x20type=\x22text\x22\x20id=\x22OrderGiftRefID','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveOrder(\x27','BMAllocated','OrderGiftID17','173775LBlPXR','</td></tr></tbody></table>','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;background:#73a0f4;\x22>','\x22\x20style=\x22color:#fff;background:#0056ff;\x22></div></div>','93204LiaWEk','9720FQwrRE','BranchID','<div\x20class=\x22btn-t2\x22\x20onclick=\x22XLoadDetail()\x22\x20style=\x22margin:25px\x20auto;\x22>ปิดหน้าต่างนี้</div>','id04','replace','OrderGiftID4','OrderGiftID7','addClass','OrderGiftID15','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ยกเลิก<br>รายการสั่งซื้อ</div>','<font\x20color=\x27#ff0000\x27><b>โซนแจ้งทบทวนใหม่</b></font>','update','UnitPrice','OrderGiftID','UnitPrice8','getItem','</div><div\x20style=\x22margin-top:30px;padding-top:20px;margin-left:3px;\x22>','ShowNav','padStart','<div\x20id=\x22ShowSaveData\x22\x20style=\x22display:block;margin-bottom:\x2020px;\x22>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมทั้งหมด</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','getElementById','data','BMName','orderBy','BM_Phone','\x27)\x22><font\x20color=\x22#0056ff\x22><b>','</tr>','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>จำนวนเงินที่สั่ง</div><input\x20type=\x22text\x22\x20value=\x22','<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติจากโซน<br></div>','UnitPrice11','display','OrderGiftID6','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>เลือกจำนวนชิ้น</div>','#SumUnitPrice10','โซนแจ้ง<br>ยกเลิก','#SumUnitPrice16','<font\x20color=\x27#555555\x27><b>ยังไม่ได้สั่งจอง</b></font>','EmpName_Staff2','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20center;\x22>','block','EmpID_Staff1','<div\x20style=\x22font-weight:600;\x20color:#ff0000;line-height:1.2;\x22><font\x20color=\x22#000000\x22>โซนแจ้งทำการทบทวนการสั่งจองใหม่อีกครั้ง</font><br>','<div><img\x20src=\x22','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff1\x22\x20value=\x22','4638jHfhus','firestore','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายการสั่งซื้อ<br>ของขวัญปีใหม่</div>','BM_Address','(=([^&#]*)|&|#|$)','กำลัง<br>สั่งจอง','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>ราคาต่อชิ้น</div><input\x20type=\x22text\x22\x20id=\x22UnitPrice','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกชื่อ-นามสกุล)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpName_Staff2\x22\x20value=\x22','<div\x20class=\x22btn-t2\x22\x20onclick=location.href=\x22home.html\x22\x20type=\x22submit\x22\x20style=\x22margin-top:20px;\x22>ไม่บันทึกรายการ</div>','ส่งโซน<br>ขออนุมัติ','1533876YmSZBK','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>นำส่งรายการสั่งซื้อให้โซนอนุมัติ</div>','OrderGiftID16','test','</div>','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>บันทึกดร๊าฟ<br>รายการสั่งซื้อ</div>','\x5c$&','FieldPath','toLocaleString','<font\x20color=\x27#28c92a\x27><b>โซนอนุมัติเรียบร้อยแล้ว</b></font>','\x20บาท</b><br>คุณสั่งเกินไปแล้ว\x20<b><font\x20color=\x22#ff0000\x22>','log','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>ยอดรวมการสั่งซื้อ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','<option\x20onchange=\x22CalGift(0)\x22\x20value=\x220\x22>รอการสั่ง</option>','RefID','<div\x20style=\x22font-weight:400;padding-top:10px;\x22>ราคาขายต่อชิ้น\x20<b>','OrderGiftID5','</select></div>','filter','OrderGiftID1','documentId','<input\x20type=\x22text\x22\x20id=\x22NameGift','คุณยังกรอกข้อมูลไม่ครบถ้วน','\x20บาท</font></b><br><br><font\x20color=\x22#ff0000\x22><b>ระบบจะไม่อนุญาตให้บันทึกรายการสั่งจอง</b></font></div>','UnitPrice4','UnitPrice9','txtBM_Phone','<div\x20onclick=\x22DisplayGift(\x27','txtPhone_Staff1','<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>สาขา</td>','<div><br><br><font\x20color=\x22#ff0000\x22><b>ระบบได้ทำการลบรายการสั่งจองของขวัญ<br>ของคุณเรียบร้อยแล้ว</b></font><br><br></div>','<div\x20class=\x22btn-z2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ทำการแก้ไข<br>ใหม่อีกครั้ง</div>','UnitPrice17','</textarea></center></div>','StockStatus','<div\x20style=\x22font-weight:600;\x22>','#SumUnitPrice17','OrderGiftID3','RefGift','#DisplayGift','href','NameGift','\x22\x20class=\x22form-control\x22>','<br>','<font\x20color=\x27#f68b1f\x27><b>อยู่ระหว่างการสั่งจอง</b></font>','<option\x20onchange=\x22CalGift(','\x22\x20hidden>','\x22\x20readonly></div></div>','<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>','get','BranchName','disabledbutton','\x22\x20style=\x22text-align:left;\x22></div>','getDate','\x27)\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>บันทึกดร๊าฟ<br>ก่อนส่งโซน</div>','StockName','split','23470LkzmOs','EmpID_Staff2','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff2\x22\x20value=\x22','UnitPrice0','5509yEKjuu','\x22\x20value=\x22','BMStatus','id03','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>BM</td>','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22margin-top:20px;\x20background-color:\x20#fff;\x22>','OrderGiftID10','OrderGiftID8','OrderGiftID11','OrderGiftRefID','OrderGiftID2','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff1\x22\x20value=\x22','EmpName_Staff1','doc','UnitPrice5','id05','729069FrOuIF','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;\x22>จำนวนเงินที่ใช้</div><div\x20class=\x22box-order\x22\x20id=\x22SumUnitPrice','#SumUnitPrice15','#SumUnitPrice4','\x22\x20selected>','</tbody></table>','delete','<center><div\x20class=\x22btn-t3\x22\x20style=\x22margin-top:25px;\x22><b>รายละเอียดของขวัญปีใหม่</b></div>','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>','<div\x20class=\x22txtmsg\x22>ขณะนี้รายการการจัดซื้อของขวัญของสาขา\x20อยู่ระหว่างการอนุมัติโดยโซนที่ดูแลสาขาของท่าน\x20กรุณารอการอนุมัติ</div>','#SumUnitPrice12','<td\x20style=\x22text-align:\x20center;background:#c4d0e2;\x22><b>','value','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto;\x20background:#ff0000\x20!important;\x20border:2px\x20solid\x20#cc3c3c\x20!important;\x22>ข้อความแจ้งเตือน</div>','<div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto;\x20background:#28a745\x20!important;\x20border:2px\x20solid\x20#52c76c\x20!important;\x22>ยืนยันการบันทึกรายการของคุณ</div>','#SumUnitPrice1','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:20px\x2010px\x2020px\x20auto;\x22>ปิดหน้าต่าง<br>รายการนี้</div>','</td></tr>','<div\x20class=\x22btn-z3\x22\x20onclick=\x22SaveToZone(\x27','home.html','StockGroup','OrderGiftID9','UnitPrice15','<div>ขณะนี้คุณได้ทำคำสั่งซื้อของขวัญปีใหม่<br><br>จากงบประมาณที่ได้รับ\x20<b>','<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>','en-US','UnitPrice16','id01','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณคงเหลือ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#0056ff;\x22>','gID=','<div\x20class=\x22btn-z0\x22\x20onclick=\x22ViewOrder(\x27','txtPhone_Staff2','OrderGiftID18','<div>ระบบได้ทำการบันทึกรายการนี้เรียบร้อยแล้ว<br>หากไม่มีการแก้ไขรายการให้ทำการ<br><br>กดปุ่ม\x20...\x20<b>ส่งคำขอให้โซนอนุมัติ</b><br><br><font\x20color=\x22#ff0000\x22><b>ซึ่งจะมีผลให้สาขา<br>ไม่สามารถทำการแก้ไขรายการได้แล้ว</b></font></div>','exec','\x20บาท</b></td></tr>','<div\x20class=\x22btn-z3\x22\x20onclick=\x22DeleteAllOrder(\x27','ordergift.html?gid=','ZoneMemoToBM','txtEmpID_Staff2','txtBM_Address','\x22\x20readonly></div>','บันทึกรายการแก้ไขรายการ\x20','idSendZoneApprove','#SumUnitPrice13','Phone_Staff1','StockImg','#DisplayGroup2','style','txtEmpName_Staff2','\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>','#DisplayBudget','UnitPrice14','push','OrderGiftID14','StockOrder','1562WtGcvt','<div\x20class=\x22clr\x22></div>','OrderGift','UnitPrice3',')\x22\x20value=\x22','txtEmpName_Staff1','โซนแจ้ง<br>อนุมัติ','<div\x20style=\x22line-height:1.3;\x20text-align:left;\x20font-weight:600;\x22>สาขา\x20:\x20','\x20บาท</b></div>','</b></td></tr>','length','</td>','#TotalGift','then','<hr><div\x20style=\x22margin-top:-10px;text-align:left;padding-bottom:\x2010px;line-height:1.3;\x20padding-left:10px;\x22>BM\x20:\x20<b>','<div\x20class=\x22btn-t2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:15px\x20auto\x2025px\x20auto;\x22>ปิดหน้าต่างนี้</div>','gid','#SumUnitPrice3','id02','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>จำนวน</th><th\x20scope=\x22col\x22>ราคา</th></tr></thead><tbody>','toFixed','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x20margin-top:20px;\x22>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>','<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;\x22>','296cTDDDj','<div\x20class=\x22btn-z0\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:50px;\x22>ปิด<br>หน้าต่าง</div>','getMonth','asc','where','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>รวมยอดการสั่งจองของขวัญ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#31e85b;\x22>','<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;background:#73a0f4;\x22>สรุปรายการสั่งซื้อ</th>','<th\x20scope=\x22col\x22>No.</th><th\x20scope=\x22col\x22>รายการของขวัญ</th></tr></thead><tbody>','UnitPrice7','forEach','none','<div\x20class=\x22btn-z1\x22\x20onclick=\x22SaveDetail(\x27','</th>','OrderGiftID12','#SumUnitPrice9','[?&]','getFullYear','<th\x20scope=\x22col\x22>รายการ</th><th\x20scope=\x22col\x22>รายละเอียด</th></tr></thead><tbody>','<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#e831e8;\x22>','\x20ชิ้น</option>','</tbody></table></div>','ready','<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>โทรศัพท์ผู้จัดการสาขา</div><input\x20type=\x22text\x22\x20id=\x22txtBM_Phone\x22\x20value=\x22','<tr>','<div\x20class=\x22btn-z0\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:50px;\x22>กลับ<br>หน้าแรก</div>','html','<br>BM\x20:\x20','add','txtEmpID_Staff1','PointRedeem','<font\x20color=\x27#ff0000\x27><b>โซนแจ้งขอยกเลิกการจอง</b></font>','EmpRH','UnitPrice2','#SumUnitPrice2','<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;background-color:#d5dae2\x22>งบสั่งจอง</td>','</b></div>','#WarningText','OrderGiftID0','<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>ยอดงบคงเหลือ</div><input\x20type=\x22text\x22\x20value=\x22','<center><div\x20class=\x22btn-t1\x22\x20onclick=\x22GotoOrder()\x22>ปิดหน้าต่างนี้</div></center>','<center><div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto\x2020px\x20auto;\x22><b>รายการสั่งซื้อของขวัญปีใหม่ของสาขา</b></div></center>'];_0x3ba1=function(){return _0x213f9b;};return _0x3ba1();}function LoadGiftStock(){var _0x22fdcb=_0x1872e4;LoadDetail();var _0x2c4416='',_0x157a5e=0x0,_0x1deeaf=0x0;xSumAllPrice=0x0,xSumUnitPrice=0x0,xMaxGift=0x0,xCalSell=0x0,_0x2c4416+=_0x22fdcb(0x1c1),_0x2c4416+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',_0x2c4416+=_0x22fdcb(0x1c9),dbGiftStock[_0x22fdcb(0x1c6)](_0x22fdcb(0x254),'==',0x1)[_0x22fdcb(0x212)](_0x22fdcb(0x186),_0x22fdcb(0x1c5))[_0x22fdcb(0x212)](_0x22fdcb(0x1a9),'asc')[_0x22fdcb(0x263)]()[_0x22fdcb(0x1b7)](_0x4e19bb=>{var _0x5590d6=_0x22fdcb;_0x4e19bb[_0x5590d6(0x1cb)](_0x5eadf0=>{var _0x45acf1=_0x5590d6;const _0x411846=GetOrderArr[_0x45acf1(0x243)](_0x2c875c=>{return _0x2c875c['RefGift']===_0x5eadf0['id'];});xResults=0x0,xCheckLine=0x0;_0x411846[0x0]!=undefined&&(xResults=_0x411846[0x0][_0x45acf1(0x1ac)],xCheckOrder=parseFloat(xCheckOrder)+parseFloat(_0x411846[0x0][_0x45acf1(0x1ac)]));_0x2c4416+=_0x45acf1(0x221)+(_0x157a5e+0x1)+_0x45acf1(0x24c)+_0x5eadf0['id']+'\x27)\x22><img\x20src=\x22./img/icon-02.png\x22\x20style=\x22width:20px;\x22></div></th>',_0x2c4416+='<td\x20style=\x22text-align:\x20left;\x20line-height:\x201.2;\x22><div\x20onclick=\x22DisplayGift(\x27'+_0x5eadf0['id']+_0x45acf1(0x214)+_0x5eadf0[_0x45acf1(0x210)]()[_0x45acf1(0x269)]+'</b></font></div>',_0x2c4416+='<div\x20style=\x22margin-top:4px;\x22>',_0x2c4416+=_0x45acf1(0x21b),_0x2c4416+='<select\x20name=\x22OrderGiftID\x22\x20onchange=\x22CalGift()\x22\x20id=\x22OrderGiftID'+_0x157a5e+_0x45acf1(0x270)+xResults+_0x45acf1(0x25c);if(_0x5eadf0[_0x45acf1(0x210)]()[_0x45acf1(0x1ef)]==0x1)for(let _0x4d41d6=0x0;_0x4d41d6<xNewyearLimit;_0x4d41d6++){_0x4d41d6==0x0?_0x2c4416+=_0x45acf1(0x23e):xResults==_0x4d41d6*0x32?(xCheckLine=0x1,_0x2c4416+=_0x45acf1(0x25f)+_0x4d41d6+')\x22\x20value=\x22'+_0x411846[0x0][_0x45acf1(0x1ac)]+_0x45acf1(0x176)+_0x411846[0x0][_0x45acf1(0x1ac)]+_0x45acf1(0x1d5)):_0x2c4416+='<option\x20onchange=\x22CalGift('+_0x4d41d6+')\x22\x20value=\x22'+_0x4d41d6*0x32+'\x22>'+_0x4d41d6*0x32+_0x45acf1(0x1d5);}else{if(_0x5eadf0[_0x45acf1(0x210)]()[_0x45acf1(0x1ef)]==0x2)for(let _0x578f28=0x0;_0x578f28<xOrderLimit+0x1;_0x578f28++){_0x578f28==0x0?_0x2c4416+=_0x45acf1(0x23e):xResults==_0x578f28?(xCheckLine=0x1,_0x2c4416+=_0x45acf1(0x25f)+_0x578f28+_0x45acf1(0x1ae)+_0x411846[0x0]['OrderGift']+_0x45acf1(0x176)+_0x411846[0x0][_0x45acf1(0x1ac)]+'\x20ชิ้น</option>'):_0x2c4416+=_0x45acf1(0x25f)+_0x578f28+_0x45acf1(0x1ae)+_0x578f28+'\x22>'+_0x578f28+_0x45acf1(0x1d5);}}xCalSell+=xResults*_0x5eadf0[_0x45acf1(0x210)]()['PointRedeem'],_0x2c4416+=_0x45acf1(0x242),_0x2c4416+=_0x45acf1(0x22d)+_0x157a5e+_0x45acf1(0x270)+_0x5eadf0[_0x45acf1(0x210)]()[_0x45acf1(0x1df)]+_0x45acf1(0x19b),_0x2c4416+=_0x45acf1(0x280)+_0x157a5e+_0x45acf1(0x270)+xResults*_0x5eadf0[_0x45acf1(0x210)]()['PointRedeem']+_0x45acf1(0x261),_0x2c4416+='</td>',_0x2c4416+=_0x45acf1(0x215),_0x2c4416+=_0x45acf1(0x1f1)+_0x157a5e+_0x45acf1(0x270)+_0x5eadf0['id']+_0x45acf1(0x260),_0x2c4416+=_0x45acf1(0x246)+_0x157a5e+_0x45acf1(0x270)+_0x5eadf0['data']()[_0x45acf1(0x269)]+_0x45acf1(0x260),_0x157a5e++,xMaxGift++;}),_0x2c4416+=_0x5590d6(0x1d6),_0x2c4416+=_0x5590d6(0x1ab),$(_0x5590d6(0x1a1))[_0x5590d6(0x1db)](_0x2c4416),CalGift();});}var xTotalPrice=0x0;function CalGift(){var _0xad483c=_0x1872e4,_0x410d12=0x0,_0x5b3fac='',_0x3ea8ff=0x0,_0x589c6c=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x26e))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x1e7))[_0xad483c(0x17e)]),_0x2e3b5e=parseFloat(document[_0xad483c(0x20f)]('UnitPrice1')[_0xad483c(0x17e)]*document['getElementById'](_0xad483c(0x244))[_0xad483c(0x17e)]),_0x393162=parseFloat(document['getElementById'](_0xad483c(0x1e2))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x279))[_0xad483c(0x17e)]),_0x2c0eb1=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x1ad))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)]('OrderGiftID3')[_0xad483c(0x17e)]),_0x2711cc=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x249))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x1ff))[_0xad483c(0x17e)]),_0x3191a2=parseFloat(document['getElementById'](_0xad483c(0x27d))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x241))[_0xad483c(0x17e)]),_0x4e9c33=parseFloat(document[_0xad483c(0x20f)]('UnitPrice6')[_0xad483c(0x17e)]*document['getElementById'](_0xad483c(0x21a))[_0xad483c(0x17e)]),_0x103016=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x1ca))[_0xad483c(0x17e)]*document['getElementById'](_0xad483c(0x200))[_0xad483c(0x17e)]),_0x343f83=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x208))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)]('OrderGiftID8')['value']),_0x4fb536=parseFloat(document['getElementById'](_0xad483c(0x24a))['value']*document[_0xad483c(0x20f)](_0xad483c(0x187))[_0xad483c(0x17e)]),_0x421be4=parseFloat(document[_0xad483c(0x20f)]('UnitPrice10')[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x275))[_0xad483c(0x17e)]),_0x484d54=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x218))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)]('OrderGiftID11')[_0xad483c(0x17e)]),_0x44913e=parseFloat(document[_0xad483c(0x20f)]('UnitPrice12')[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x1cf))[_0xad483c(0x17e)]),_0x15be27=parseFloat(document['getElementById']('UnitPrice13')['value']*document[_0xad483c(0x20f)](_0xad483c(0x1eb))[_0xad483c(0x17e)]),_0x42cb92=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x1a6))['value']*document[_0xad483c(0x20f)](_0xad483c(0x1a8))['value']),_0x365352=parseFloat(document['getElementById'](_0xad483c(0x188))[_0xad483c(0x17e)]*document['getElementById'](_0xad483c(0x202))[_0xad483c(0x17e)]),_0x342d1a=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x18c))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x233))['value']),_0x4fc5dc=parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x252))[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x1f4))['value']),_0x17aab5=parseFloat(document['getElementById']('UnitPrice18')[_0xad483c(0x17e)]*document[_0xad483c(0x20f)](_0xad483c(0x192))['value']),_0x3f199d=parseFloat(document['getElementById'](_0xad483c(0x1e7))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x244))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)]('OrderGiftID2')['value'])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x257))[_0xad483c(0x17e)])+parseFloat(document['getElementById'](_0xad483c(0x1ff))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)]('OrderGiftID5')[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x21a))[_0xad483c(0x17e)]),_0x5152cf=parseFloat(document[_0xad483c(0x20f)]('OrderGiftID7')['value'])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x276))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x187))['value'])+parseFloat(document['getElementById'](_0xad483c(0x275))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x277))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x1cf))[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x1eb))[_0xad483c(0x17e)]),_0x9a2cb8=parseFloat(document['getElementById']('OrderGiftID14')[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)]('OrderGiftID15')[_0xad483c(0x17e)])+parseFloat(document[_0xad483c(0x20f)](_0xad483c(0x233))['value'])+parseFloat(document[_0xad483c(0x20f)]('OrderGiftID17')[_0xad483c(0x17e)])+parseFloat(document['getElementById']('OrderGiftID18')[_0xad483c(0x17e)]);xTotalUnitPrice=_0x3f199d+_0x5152cf+_0x9a2cb8;var _0x2eb6f1=parseFloat(_0x589c6c)+parseFloat(_0x2e3b5e)+parseFloat(_0x393162)+parseFloat(_0x2c0eb1)+parseFloat(_0x2711cc)+parseFloat(_0x3191a2),_0x24275b=parseFloat(_0x4e9c33)+parseFloat(_0x103016)+parseFloat(_0x343f83)+parseFloat(_0x4fb536)+parseFloat(_0x421be4)+parseFloat(_0x484d54),_0x1346d5=parseFloat(_0x44913e)+parseFloat(_0x15be27)+parseFloat(_0x42cb92)+parseFloat(_0x365352)+parseFloat(_0x342d1a)+parseFloat(_0x4fc5dc)+parseFloat(_0x17aab5);xTotalPrice=_0x2eb6f1+_0x24275b+_0x1346d5,xBalance=xBMAllocated-xTotalPrice,$('#SumUnitPrice0')['html'](numberWithCommas(_0x589c6c)),$(_0xad483c(0x181))['html'](numberWithCommas(_0x2e3b5e)),$(_0xad483c(0x1e3))[_0xad483c(0x1db)](numberWithCommas(_0x393162)),$(_0xad483c(0x1bb))[_0xad483c(0x1db)](numberWithCommas(_0x2c0eb1)),$(_0xad483c(0x282))[_0xad483c(0x1db)](numberWithCommas(_0x2711cc)),$('#SumUnitPrice5')[_0xad483c(0x1db)](numberWithCommas(_0x3191a2)),$('#SumUnitPrice6')[_0xad483c(0x1db)](numberWithCommas(_0x4e9c33)),$('#SumUnitPrice7')[_0xad483c(0x1db)](numberWithCommas(_0x103016)),$('#SumUnitPrice8')[_0xad483c(0x1db)](numberWithCommas(_0x343f83)),$(_0xad483c(0x1d0))[_0xad483c(0x1db)](numberWithCommas(_0x4fb536)),$(_0xad483c(0x21c))['html'](numberWithCommas(_0x421be4)),$('#SumUnitPrice11')[_0xad483c(0x1db)](numberWithCommas(_0x484d54)),$(_0xad483c(0x17c))['html'](numberWithCommas(_0x44913e)),$(_0xad483c(0x19e))[_0xad483c(0x1db)](numberWithCommas(_0x15be27)),$('#SumUnitPrice14')['html'](numberWithCommas(_0x42cb92)),$(_0xad483c(0x281))[_0xad483c(0x1db)](numberWithCommas(_0x365352)),$(_0xad483c(0x21e))[_0xad483c(0x1db)](numberWithCommas(_0x342d1a)),$(_0xad483c(0x256))[_0xad483c(0x1db)](numberWithCommas(_0x4fc5dc)),$('#SumUnitPrice18')[_0xad483c(0x1db)](numberWithCommas(_0x17aab5)),_0x5b3fac+='<div\x20class=\x22clr\x22></div>',_0x5b3fac+=_0xad483c(0x20a),_0x5b3fac+='<div\x20class=\x22box-price\x22><div\x20style=\x22font-size:12px;font-weight:600;\x22>งบประมาณที่ได้รับ</div><input\x20type=\x22text\x22\x20value=\x22'+numberWithCommas(xBMAllocated)+'\x22\x20style=\x22color:#fff;background:#002d63;\x22></div></div>',_0x5b3fac+=_0xad483c(0x216)+numberWithCommas(xTotalPrice)+_0xad483c(0x1f8);xBalance>=0x0?_0x5b3fac+=_0xad483c(0x1e8)+numberWithCommas(xBalance)+'\x22\x20style=\x22color:#fff;background:#13c33b;\x22></div></div>':_0x5b3fac+=_0xad483c(0x1e8)+numberWithCommas(xBalance)+'\x22\x20style=\x22color:#fff;background:#ff0000;\x22></div></div>';_0x5b3fac+=_0xad483c(0x235),_0x5b3fac+=_0xad483c(0x1ab);var _0x13ee7d=xBMAllocated-xTotalPrice;if(xBMAllocated-xTotalPrice>=0x0){_0x5b3fac+=_0xad483c(0x20d);if(xBMStatus==0x0||xBMStatus==0x1)xTotalUnitPrice!=0x0?(_0x5b3fac+=_0xad483c(0x1da),xTotalUnitPrice!=0x0&&(_0x5b3fac+=_0xad483c(0x196)+gID+_0xad483c(0x203)),_0x5b3fac+=_0xad483c(0x1f2)+gID+_0xad483c(0x236)):(_0x5b3fac+='<div\x20class=\x22btn-z0\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กรุณาสั่ง<br>ของขวัญปีใหม่</div>',_0x5b3fac+='<div\x20class=\x22btn-z1\x22\x20onclick=\x22GotoOrder()\x22\x20style=\x22margin:10px\x2010px\x2020px\x20auto;min-width:100px;\x22>กลับไป<br>หน้าแรก</div>');else{if(xBMStatus==0x2)_0x5b3fac+=_0xad483c(0x190)+gID+_0xad483c(0x1a4),_0x5b3fac+=_0xad483c(0x262),_0x5b3fac+=_0xad483c(0x217);else{if(xBMStatus==0x3)xTotalUnitPrice!=0x0&&(_0x5b3fac+=_0xad483c(0x1f2)+gID+_0xad483c(0x236),_0x5b3fac+=_0xad483c(0x224)+zZoneMemoToBM+_0xad483c(0x235));else xBMStatus==0x9?(_0x5b3fac+='<div\x20class=\x22btn-z9\x22\x20onclick=\x22ViewOrder(\x27'+gID+_0xad483c(0x229),_0x5b3fac+='<div\x20style=\x22font-weight:600;\x20color:#0056ff;\x22>รายการของท่านได้รับการอนุมัติจากโซน\x20เรียบร้อยแล้ว<br></div>'):(_0x5b3fac+=_0xad483c(0x190)+gID+'\x27)\x22\x20style=\x22margin:10px\x2010px\x2010px\x20auto;min-width:100px;\x22>ดูรายละเอียด<br>รายการสั่งซื้อ</div>',_0x5b3fac+='<div\x20style=\x22font-weight:600;\x22>รายการอยู่ระหว่างการขออนุมัติการสั่งจองของขวัญปีใหม่<br></div>');}}_0x5b3fac+=_0xad483c(0x235);}else{var _0x411be7='';_0x411be7+=_0xad483c(0x17f),_0x411be7+=_0xad483c(0x189)+numberWithCommas(xBMAllocated)+'\x20บาท</b><br>ยอดสั่งของขวัญของคุณ\x20<b>'+numberWithCommas(xTotalPrice)+_0xad483c(0x23b)+numberWithCommas(_0x13ee7d)+_0xad483c(0x248),_0x411be7+='<div\x20class=\x22clr\x22></div>',_0x411be7+='<div\x20class=\x22btn-t2\x22\x20onclick=\x22CloseAll()\x22\x20style=\x22margin:25px\x20auto;\x22>ปิดหน้าต่างนี้</div>',$('#WarningText')[_0xad483c(0x1db)](_0x411be7),document[_0xad483c(0x20f)](_0xad483c(0x1fd))['style'][_0xad483c(0x219)]=_0xad483c(0x222),_0x5b3fac+=_0xad483c(0x22f);}_0x5b3fac+=_0xad483c(0x1b8)+xBMName+'</b><br>Branch\x20:\x20<b>'+xBranchName+_0xad483c(0x1e5),$(_0xad483c(0x1b6))[_0xad483c(0x1db)](_0x5b3fac);}function DisplayGift(_0x137ee4){var _0x3fdc7e=_0x1872e4,_0x3dd95f='';dbGiftStock[_0x3fdc7e(0x1c6)](firebase[_0x3fdc7e(0x228)][_0x3fdc7e(0x238)]['documentId'](),'==',_0x137ee4)[_0x3fdc7e(0x263)]()[_0x3fdc7e(0x1b7)](_0x49b648=>{var _0xa9044f=_0x3fdc7e;_0x49b648[_0xa9044f(0x1cb)](_0x271202=>{var _0x95da85=_0xa9044f;_0x3dd95f+=_0x95da85(0x179),_0x3dd95f+=_0x95da85(0x225)+_0x271202[_0x95da85(0x210)]()[_0x95da85(0x1a0)]+'\x22\x20style=\x22width:100%;margin-top:18px;margin-bottom:\x2010px;\x22></div></center>',_0x3dd95f+=_0x95da85(0x255)+_0x271202['data']()[_0x95da85(0x269)]+_0x95da85(0x235),_0x3dd95f+='<div\x20style=\x22font-weight:400;\x20text-align:left;\x20padding-top:10px;\x22>'+_0x271202[_0x95da85(0x210)]()['StockDetail']+_0x95da85(0x235),_0x3dd95f+=_0x95da85(0x240)+_0x271202[_0x95da85(0x210)]()[_0x95da85(0x1df)]+_0x95da85(0x1b2),_0x3dd95f+='',_0x3dd95f+='',_0x3dd95f+='<div\x20class=\x22clr\x22></div>',_0x3dd95f+=_0x95da85(0x1b9);}),$(_0xa9044f(0x259))[_0xa9044f(0x1db)](_0x3dd95f);}),document[_0x3fdc7e(0x20f)]('id03')['style'][_0x3fdc7e(0x219)]=_0x3fdc7e(0x222);}function DeleteAllOrder(_0x4ee0fa){var _0xddc655=_0x1872e4;dbGiftOrder[_0xddc655(0x1c6)](_0xddc655(0x23f),'==',_0x4ee0fa)[_0xddc655(0x263)]()['then'](_0x490415=>{var _0x324ff1=_0xddc655;_0x490415[_0x324ff1(0x1cb)](_0x2309e5=>{var _0x140044=_0x324ff1;dbGiftOrder[_0x140044(0x27c)]()[_0x140044(0x178)](),DeleteRefID(_0x2309e5['id']);}),console['log'](_0x324ff1(0x18f)+gID);var _0x5223a5=0x3e8;setTimeout(function(){var _0x237145=_0x324ff1;dbNewyearData[_0x237145(0x27c)](gID)[_0x237145(0x205)]({'BMStatus':0x0,'TotalOrders':0x0,'UseBudget':0x0,'BMBalance':0x0});},_0x5223a5);var _0x198e01=0x7d0;setTimeout(function(){var _0x586aa0=_0x324ff1,_0xc2ad1c='';_0xc2ad1c+='<div\x20class=\x22btn-t22a\x22\x20style=\x22margin:30px\x20auto;\x20background:#ff0000\x20!important;\x20border:2px\x20solid\x20#cc3c3c\x20!important;\x22>ยืนยันการลบรายการของคุณ</div>',_0xc2ad1c+=_0x586aa0(0x250),_0xc2ad1c+=_0x586aa0(0x1ab),_0xc2ad1c+='<div\x20class=\x22btn-t2\x22\x20onclick=\x22GotoMyOrder()\x22\x20style=\x22margin:40px\x20auto\x2025px\x20auto;\x22>ปิดหน้าต่างนี้</div>',$('#DeleteingText')['html'](_0xc2ad1c),document[_0x586aa0(0x20f)](_0x586aa0(0x27e))[_0x586aa0(0x1a2)][_0x586aa0(0x219)]=_0x586aa0(0x222);},_0x198e01);});}function DeleteRefID(_0x217fb3){var _0x29aea0=_0x1872e4;dbGiftOrder[_0x29aea0(0x27c)](_0x217fb3)['delete'](),console[_0x29aea0(0x23c)](_0x217fb3);}function _0x28cf(_0x163ad7,_0x3d050b){var _0x3ba1ee=_0x3ba1();return _0x28cf=function(_0x28cfe3,_0x2de49b){_0x28cfe3=_0x28cfe3-0x176;var _0xf444ca=_0x3ba1ee[_0x28cfe3];return _0xf444ca;},_0x28cf(_0x163ad7,_0x3d050b);}function ViewOrder(_0x5542d8){var _0x14182f=_0x1872e4,_0x1d1b48='',_0xbeb69b=0x0,_0x5b715e=0x0;_0x1d1b48+=_0x14182f(0x1ea),_0x1d1b48+=_0x14182f(0x1b1)+xBranchName+_0x14182f(0x1dc)+xBMName+_0x14182f(0x235),_0x1d1b48+='<table\x20class=\x22table\x20table-bordered\x22\x20class=\x22font13\x22\x20style=\x22background-color:\x20#fff;margin-top:10px;\x22>',_0x1d1b48+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',_0x1d1b48+=_0x14182f(0x1bd),dbGiftOrder['where']('RefID','==',_0x5542d8)[_0x14182f(0x212)](_0x14182f(0x269),'asc')['get']()[_0x14182f(0x1b7)](_0x2b7047=>{var _0x1a1d96=_0x14182f;_0x2b7047[_0x1a1d96(0x1cb)](_0x381448=>{var _0x12615d=_0x1a1d96;_0xbeb69b=_0xbeb69b+_0x381448[_0x12615d(0x210)]()[_0x12615d(0x1ac)],_0x5b715e=_0x5b715e+_0x381448[_0x12615d(0x210)]()['OrderGift']*_0x381448[_0x12615d(0x210)]()['PointRedeem'],_0x1d1b48+=_0x12615d(0x17a)+_0x381448[_0x12615d(0x210)]()[_0x12615d(0x269)]+_0x12615d(0x1ce),_0x1d1b48+=_0x12615d(0x24e)+_0x381448[_0x12615d(0x210)]()['OrderGift']+'</td>',_0x1d1b48+=_0x12615d(0x24e)+numberWithCommas(_0x381448[_0x12615d(0x210)]()[_0x12615d(0x1ac)]*_0x381448[_0x12615d(0x210)]()['PointRedeem'])+_0x12615d(0x183);}),_0x1d1b48+=_0x1a1d96(0x1c8),_0x1d1b48+=_0x1a1d96(0x1f7)+addCommas(_0xbeb69b)+_0x1a1d96(0x1b5),_0x1d1b48+=_0x1a1d96(0x1f7)+numberWithCommas(_0x5b715e)+_0x1a1d96(0x183),_0x1d1b48+=_0x1a1d96(0x1d4)+numberWithCommas(xBMAllocated)+_0x1a1d96(0x183),_0x1d1b48+=_0x1a1d96(0x23d)+numberWithCommas(_0x5b715e)+_0x1a1d96(0x183),_0x1d1b48+=_0x1a1d96(0x18e)+numberWithCommas(xBMAllocated-_0x5b715e)+_0x1a1d96(0x183),_0x1d1b48+=_0x1a1d96(0x177),_0x1d1b48+=_0x1a1d96(0x182),$(_0x1a1d96(0x259))[_0x1a1d96(0x1db)](_0x1d1b48);}),document[_0x14182f(0x20f)](_0x14182f(0x272))['style'][_0x14182f(0x219)]='block';}function SaveOrder(){var _0x16202c=_0x1872e4;LoadDetail();var _0x276a37=0x0,_0x125f8b=0x0,_0x5ecdd='',_0x12fa61=0x0,_0x16f350='';console[_0x16202c(0x23c)](xMaxGift);for(let _0x4839a3=0x0;_0x4839a3<xMaxGift;_0x4839a3++){var _0x30a32d=document[_0x16202c(0x20f)](_0x16202c(0x207)+_0x4839a3)[_0x16202c(0x17e)]*document[_0x16202c(0x20f)]('UnitPrice'+_0x4839a3)[_0x16202c(0x17e)];SaveGift(document[_0x16202c(0x20f)](_0x16202c(0x278)+_0x4839a3)['value'],document[_0x16202c(0x20f)](_0x16202c(0x206)+_0x4839a3)[_0x16202c(0x17e)],document[_0x16202c(0x20f)](_0x16202c(0x207)+_0x4839a3)[_0x16202c(0x17e)],_0x30a32d,document[_0x16202c(0x20f)]('NameGift'+_0x4839a3)[_0x16202c(0x17e)]);}}var xSumMoney=0x0;function SaveGift(_0x40899f,_0x57a6a1,_0x3c614b,_0x452c7e,_0x21976a){var _0x20b530=_0x1872e4;document[_0x20b530(0x20f)](_0x20b530(0x20b))[_0x20b530(0x1a2)][_0x20b530(0x219)]=_0x20b530(0x1cc),LoadDetail(),xSumMoney=0x0;var _0x26739d='',_0x6e340a='',_0x4cd347=0x0;xSumMoney=xSumMoney+xTotalPrice,dbGiftOrder[_0x20b530(0x1c6)]('RefID','==',gID)['where'](_0x20b530(0x258),'==',_0x40899f)[_0x20b530(0x263)]()[_0x20b530(0x1b7)](_0x23e540=>{var _0x192f2f=_0x20b530;_0x23e540[_0x192f2f(0x1cb)](_0x5e8168=>{_0x6e340a=_0x5e8168['id'],_0x4cd347=0x1;});if(_0x3c614b==0x0)dbGiftOrder[_0x192f2f(0x27c)](_0x6e340a)[_0x192f2f(0x178)]();else{if(_0x4cd347==0x1){var _0x45a415=parseFloat(_0x3c614b*_0x57a6a1);dbGiftOrder[_0x192f2f(0x27c)](_0x6e340a)[_0x192f2f(0x205)]({'OrderGift':parseFloat(_0x3c614b),'OrderPrice':parseFloat(_0x3c614b*_0x57a6a1),'PointRedeem':parseFloat(_0x57a6a1)});}else dbGiftOrder[_0x192f2f(0x1dd)]({'RefID':gID,'RefGift':_0x40899f,'EmpID':xBMEmpID,'EmpName':xBMName,'EmpBR':xBranchName,'EmpZone':xZone,'EmpRH':xRH,'OrderGift':parseFloat(_0x3c614b),'OrderPrice':parseFloat(_0x3c614b*_0x57a6a1),'PointRedeem':parseFloat(_0x57a6a1),'StockName':_0x21976a});}});var _0x3d600a=0x0,_0x5bbedf=0x0;_0x26739d+='<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>บันทึกการสั่งจองของขวัญปีใหม่</div>',_0x26739d+=_0x20b530(0x1bf),_0x26739d+=_0x20b530(0x18a),_0x26739d+=_0x20b530(0x1bd);for(let _0x7d54d8=0x0;_0x7d54d8<xMaxGift;_0x7d54d8++){document[_0x20b530(0x20f)](_0x20b530(0x207)+_0x7d54d8)[_0x20b530(0x17e)]!=0x0&&(_0x26739d+='<tr><th\x20scope=\x22row\x22\x20style=\x22text-align:\x20left;\x22>'+document[_0x20b530(0x20f)](_0x20b530(0x25b)+_0x7d54d8)[_0x20b530(0x17e)]+_0x20b530(0x1ce),_0x26739d+=_0x20b530(0x24e)+document[_0x20b530(0x20f)](_0x20b530(0x207)+_0x7d54d8)[_0x20b530(0x17e)]+_0x20b530(0x1b5),_0x26739d+=_0x20b530(0x24e)+numberWithCommas(document['getElementById'](_0x20b530(0x207)+_0x7d54d8)[_0x20b530(0x17e)]*document['getElementById'](_0x20b530(0x206)+_0x7d54d8)[_0x20b530(0x17e)])+_0x20b530(0x183),_0x5bbedf++);}_0x26739d+=_0x20b530(0x1c7)+numberWithCommas(xSumMoney)+_0x20b530(0x183),_0x26739d+='<tr><td\x20style=\x22text-align:\x20center;font-weight:\x20600;background:#f1f1f1;\x22>งบประมาณที่ได้รับ</td><td\x20colspan=\x222\x22\x20style=\x22text-align:\x20right;font-weight:\x20600;background:#f68b1f;\x22>'+numberWithCommas(xBMAllocated)+_0x20b530(0x183),_0x26739d+=_0x20b530(0x18e)+numberWithCommas(xBMAllocated-xSumMoney)+_0x20b530(0x1f6),_0x26739d+='<div\x20class=\x22btn-t22a\x22\x20style=\x22margin-top:15px;\x22>รายละเอียดเพิ่มเติม</div><div\x20class=\x22clr\x22></div>',_0x26739d+='<div\x20style=\x22text-align:left;\x20margin:20px\x200\x202px\x205px;\x22>ที่ตั้งสาขา-ที่จัดส่งของขวัญ</div><center><textarea\x20id=\x22txtBM_Address\x22\x20name=\x22BM_Address\x22\x20style=\x22width:98%;\x20height:80px;text-align:left;font-weight:600;\x20color:#000;\x22>'+zBM_Address+_0x20b530(0x253),_0x26739d+=_0x20b530(0x1d8)+zBM_Phone+_0x20b530(0x266),_0x26739d+='<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x201\x20(กรอกรหัสพนักงาน)</div><input\x20type=\x22text\x22\x20id=\x22txtEmpID_Staff1\x22\x20value=\x22'+zEmpID_Staff1+_0x20b530(0x266),_0x26739d+=_0x20b530(0x226)+zEmpName_Staff1+_0x20b530(0x266),_0x26739d+=_0x20b530(0x27a)+zPhone_Staff1+_0x20b530(0x266),_0x26739d+=_0x20b530(0x26d)+zEmpID_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x26739d+=_0x20b530(0x22e)+zEmpName_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x26739d+='<div\x20style=\x22text-align:left;\x20margin:10px\x200\x202px\x205px;\x22>ผู้รับสินค้า\x202\x20(กรอกหมายเลขโทรศัพท์)</div><input\x20type=\x22text\x22\x20id=\x22txtPhone_Staff2\x22\x20value=\x22'+zPhone_Staff2+'\x22\x20style=\x22text-align:left;\x22></div>',_0x26739d+=_0x20b530(0x1c3),_0x26739d+=_0x20b530(0x251),_0x26739d+=_0x20b530(0x1cd)+gID+_0x20b530(0x268),_0x26739d+=_0x20b530(0x1ab),_0x26739d+=_0x20b530(0x184)+gID+'\x27)\x22\x20style=\x22width:56%;margin:-10px\x20auto\x2020px\x20auto;display:none\x22\x20id=\x22idSendZoneApprove\x22>ส่งคำขอ<br>ให้โซนอนุมัติ</div>',$(_0x20b530(0x1ec))[_0x20b530(0x1db)](_0x26739d),$(_0x20b530(0x1f0))[_0x20b530(0x201)](_0x20b530(0x265));var _0x5c671d=_0x20b530(0x19c)+dateString+_0x20b530(0x25d),_0x5344d3=0x3e8;setTimeout(function(){var _0x448daa=_0x20b530;dbNewyearData[_0x448daa(0x27c)](gID)[_0x448daa(0x205)]({'BMStatus':0x1,'BMBalance':parseFloat(xBMAllocated-xSumMoney),'TotalOrders':parseFloat(_0x5bbedf),'TotalOrders':parseFloat(xTotalUnitPrice),'UseBudget':parseFloat(xTotalPrice),'BM_Memo':_0x5c671d});},_0x5344d3),document['getElementById'](_0x20b530(0x18d))[_0x20b530(0x1a2)]['display']=_0x20b530(0x222);}function SaveToZone(){var _0x345392=_0x1872e4,_0x3742c5=0x0,_0x5eabd4=0x0;dbNewyearData[_0x345392(0x27c)](gID)[_0x345392(0x205)]({'BMStatus':0x2}),str+=_0x345392(0x232),str+=_0x345392(0x1bf),str+='<thead><tr\x20style=\x22text-align:\x20center;background-color:\x20#93a3c1;\x22>',str+=_0x345392(0x1bd);for(let _0x588b6e=0x0;_0x588b6e<xMaxGift;_0x588b6e++){document[_0x345392(0x20f)](_0x345392(0x207)+_0x588b6e)[_0x345392(0x17e)]!=0x0&&(str+=_0x345392(0x17a)+document['getElementById'](_0x345392(0x25b)+_0x588b6e)[_0x345392(0x17e)]+_0x345392(0x1ce),str+='<td\x20style=\x22text-align:\x20right;\x20font-weight:\x20600;\x22>'+document[_0x345392(0x20f)](_0x345392(0x207)+_0x588b6e)[_0x345392(0x17e)]+_0x345392(0x1b5),str+=_0x345392(0x24e)+numberWithCommas(document[_0x345392(0x20f)]('OrderGiftID'+_0x588b6e)['value']*document[_0x345392(0x20f)](_0x345392(0x206)+_0x588b6e)[_0x345392(0x17e)])+_0x345392(0x183),_0x5eabd4++);}str+=_0x345392(0x20e)+numberWithCommas(xSumMoney)+_0x345392(0x183),str+=_0x345392(0x1c0)+numberWithCommas(xBMAllocated)+_0x345392(0x183),str+=_0x345392(0x18e)+numberWithCommas(xBMAllocated-xSumMoney)+_0x345392(0x1f6),str+=_0x345392(0x17b),str+=_0x345392(0x1e9),$('#DisplaySaveToZone')[_0x345392(0x1db)](str),document['getElementById'](_0x345392(0x1bc))[_0x345392(0x1a2)]['display']=_0x345392(0x222);}function GotoOrder(){var _0x51a9bf=_0x1872e4;location[_0x51a9bf(0x25a)]=_0x51a9bf(0x185);}function GotoMyOrder(){var _0x422852=_0x1872e4;location[_0x422852(0x25a)]=_0x422852(0x197)+gID;}function SaveDetail(){var _0xd0f42e=_0x1872e4,_0x3acb1d=document['getElementById'](_0xd0f42e(0x19a))[_0xd0f42e(0x17e)],_0x2593d3=document[_0xd0f42e(0x20f)](_0xd0f42e(0x24b))[_0xd0f42e(0x17e)],_0x59156e=document[_0xd0f42e(0x20f)]('txtEmpID_Staff1')[_0xd0f42e(0x17e)],_0x2e51b1=document[_0xd0f42e(0x20f)](_0xd0f42e(0x1af))[_0xd0f42e(0x17e)],_0x65040=document[_0xd0f42e(0x20f)]('txtPhone_Staff1')['value'],_0x5be1ca=document[_0xd0f42e(0x20f)](_0xd0f42e(0x199))[_0xd0f42e(0x17e)],_0x367227=document[_0xd0f42e(0x20f)]('txtEmpName_Staff2')['value'],_0x5a19e8=document['getElementById'](_0xd0f42e(0x191))[_0xd0f42e(0x17e)];if(_0x3acb1d==''||_0x2593d3==''||_0x59156e==''||_0x2e51b1==''||_0x65040==''||_0x5be1ca==''||_0x367227==''||_0x5a19e8=='')alert(_0xd0f42e(0x247));else{dbNewyearData[_0xd0f42e(0x27c)](gID)['update']({'BM_Address':document['getElementById']('txtBM_Address')[_0xd0f42e(0x17e)],'BM_Phone':document[_0xd0f42e(0x20f)](_0xd0f42e(0x24b))[_0xd0f42e(0x17e)],'EmpID_Staff1':document[_0xd0f42e(0x20f)](_0xd0f42e(0x1de))[_0xd0f42e(0x17e)],'EmpName_Staff1':document[_0xd0f42e(0x20f)](_0xd0f42e(0x1af))[_0xd0f42e(0x17e)],'Phone_Staff1':document[_0xd0f42e(0x20f)](_0xd0f42e(0x24d))['value'],'EmpID_Staff2':document[_0xd0f42e(0x20f)](_0xd0f42e(0x199))[_0xd0f42e(0x17e)],'EmpName_Staff2':document['getElementById'](_0xd0f42e(0x1a3))['value'],'Phone_Staff2':document[_0xd0f42e(0x20f)]('txtPhone_Staff2')[_0xd0f42e(0x17e)]});var _0x5620b6='';_0x5620b6+=_0xd0f42e(0x180),_0x5620b6+=_0xd0f42e(0x193),_0x5620b6+=_0xd0f42e(0x1ab),_0x5620b6+=_0xd0f42e(0x1fc),$(_0xd0f42e(0x1e6))[_0xd0f42e(0x1db)](_0x5620b6),document[_0xd0f42e(0x20f)](_0xd0f42e(0x1fd))['style'][_0xd0f42e(0x219)]='block',document[_0xd0f42e(0x20f)](_0xd0f42e(0x19d))['style'][_0xd0f42e(0x219)]='block';}}function XLoadDetail(){var _0x593158=_0x1872e4;document[_0x593158(0x20f)](_0x593158(0x1fd))['style'][_0x593158(0x219)]=_0x593158(0x1cc),LoadDetail();}function addCommas(_0x50947d){var _0x559fa4=_0x1872e4;_0x50947d+='',x=_0x50947d[_0x559fa4(0x26a)]('.'),x1=x[0x0],x2=x[_0x559fa4(0x1b4)]>0x1?'.'+x[0x1]:'';var _0x15baa2=/(\d+)(\d{3})/;while(_0x15baa2[_0x559fa4(0x234)](x1)){x1=x1[_0x559fa4(0x1fe)](_0x15baa2,'$1'+','+'$2');}return x1+x2;}function numberWithCommas(_0x48865f){var _0x1de32a=_0x1872e4,_0x4a79cb=_0x48865f,_0x138efc=parseFloat(_0x4a79cb)[_0x1de32a(0x1be)](0x2);return formattedString=_0x138efc['toString']()['replace'](/\B(?=(\d{3})+(?!\d))/g,',');}function CloseAll(){var _0x4d2c85=_0x1872e4;document[_0x4d2c85(0x20f)](_0x4d2c85(0x20b))[_0x4d2c85(0x1a2)][_0x4d2c85(0x219)]=_0x4d2c85(0x222),document[_0x4d2c85(0x20f)](_0x4d2c85(0x18d))[_0x4d2c85(0x1a2)]['display']=_0x4d2c85(0x1cc),document[_0x4d2c85(0x20f)](_0x4d2c85(0x1bc))[_0x4d2c85(0x1a2)]['display']='none',document[_0x4d2c85(0x20f)]('id03')['style']['display']=_0x4d2c85(0x1cc),document['getElementById']('id04')[_0x4d2c85(0x1a2)][_0x4d2c85(0x219)]=_0x4d2c85(0x1cc);}
